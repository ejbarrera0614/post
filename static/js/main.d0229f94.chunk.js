(this["webpackJsonppost-app"]=this["webpackJsonppost-app"]||[]).push([[0],{44:function(e,t,c){},45:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c(2),r=c.n(a),i=c(28),s=c.n(i),o=c(4),l=c(10),u=c(20),d=c(6),j=function(){return Object(n.jsx)("h1",{children:"Inicio de sesi\xf3n"})},O={ROUTE_POSTS:"/",ROUTE_ERROR:"/error",ACTION_CREATE:"crear",ACTION_EDIT:"editar",ENDPOINT_LANG_ES:"data/lang-es.json",COLLECTION_POST:"post-test",COLLECTION_COMMENTS:"comments",COLLECTION_REACTIONS:"reactions",COLLECTION_USERS:"users",REACTION_LIKE:"like",REACTION_DISLIKE:"dislike",REACTION_AMAZING:"amazing",IS_LOGGED:"isLoggedIn"},b=c(3),m=function(e){var t=e.children,c=e.isLoading,a=void 0===c||c;return Object(n.jsx)(n.Fragment,{children:a?Object(n.jsxs)("div",{className:"lds-ring",children:[Object(n.jsx)("div",{}),Object(n.jsx)("div",{}),Object(n.jsx)("div",{}),Object(n.jsx)("div",{})]}):Object(n.jsx)(n.Fragment,{children:t})})},p=c(7),f=c.n(p),h=c(13),x=Object(a.createContext)([]),g=x.Provider,v=x,N=c(24);c(37);N.a.initializeApp({apiKey:"AIzaSyCNmqLe1d9z6esEbyQQ4wcIFA9EUA-Z0H4",authDomain:"publicaciones-999c8.firebaseapp.com",projectId:"publicaciones-999c8",storageBucket:"publicaciones-999c8.appspot.com",messagingSenderId:"551474545342",appId:"1:551474545342:web:09126c401dd5f503f4d4ef"});var E=N.a.firestore(),S=E.collection(O.COLLECTION_POST),I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),c=Object(o.a)(t,2),n=c[0],r=c[1],i=function(){r(e)},s=function(e){var t=e.target;r(Object(b.a)(Object(b.a)({},n),{},Object(l.a)({},t.name,t.value)))};return[n,s,i]},C=c.p+"static/media/userIcon.18fcee80.png",A=function(e){var t=e.nameAuthor,c=e.desc,a=e.date,r=new Date(null===a||void 0===a?void 0:a.toDate()).toLocaleDateString();return Object(n.jsxs)("div",{className:"comment",children:[Object(n.jsx)("div",{className:"item-profile",children:Object(n.jsx)("img",{className:"profile-img",src:C,alt:t})}),Object(n.jsxs)("div",{className:"comment-section",children:[Object(n.jsx)("p",{className:"title-name",children:t}),Object(n.jsx)("p",{children:c}),Object(n.jsx)("p",{className:"text-time w-100",children:r})]})]})},L=E.collection(O.COLLECTION_POST),T=c.p+"static/media/like.af5d7d6e.svg",R=c.p+"static/media/dislike.0ac9267e.svg",w=c.p+"static/media/amazing.8fe6536c.svg",_=E.collection(O.COLLECTION_POST),k=function(e){var t=e.idPost,c=e.setReactionsState,r=Object(a.useState)(""),i=Object(o.a)(r,2),s=i[0],u=i[1],d=Object(a.useContext)(v).stateUser,j=function(e){var t=function(){try{var t=function(){var t=Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.doc(e).collection(O.COLLECTION_REACTIONS).get();case 2:t.sent.forEach((function(e){c.push(e.data())})),s.current&&i(Object(b.a)(Object(b.a)({},r),{},{data:c,loading:!1,error:null}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=[];t()}catch(n){i(Object(b.a)(Object(b.a)({},r),{},{data:null,loading:!1,error:n}))}},c=Object(a.useState)({action:t,data:[],loading:!0,error:null}),n=Object(o.a)(c,2),r=n[0],i=n[1],s=Object(a.useRef)(!0);return Object(a.useEffect)((function(){return s.current=!0,t(),function(){s.current=!1}}),[]),r}(t),m=j.action,p=j.data,x=function(){var e=Object(a.useContext)(v).setStateModal,t=Object(a.useState)({action:function(t,c){c.idAuthor?(r(Object(b.a)(Object(b.a)({},n),{},{loading:!0})),_.doc(t).collection(O.COLLECTION_REACTIONS).doc(c.idAuthor).set(c).then((function(){r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:null,isFirtsRender:!1}))})).catch((function(t){console.log(t),r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:"Ocurrio un error",isFirtsRender:!1})),e({isShow:!0,title:"Ocurri\xf3 un error.",desc:"No fue posible reaccionar a la publicaci\xf3n, intenta m\xe1s tarde.",icon:"error"})}))):e({isShow:!0,title:"Atenci\xf3n.",desc:"Debe iniciar sesi\xf3n para poder reaccionar",icon:"info"})},loading:!1,error:null,isFirtsRender:!0}),c=Object(o.a)(t,2),n=c[0],r=c[1];return n}(),g=x.action,N=x.loading,E=x.isFirtsRender,S=!1;Object(a.useEffect)((function(){E||N||m()}),[N]),Object(a.useEffect)((function(){var e,t=p.reduce((function(e,t){var c=t.type,n=t.idAuthor;return e[c]||(e[c]=0),e[c]+=1,n===d.id&&u(c),e}),(e={},Object(l.a)(e,O.REACTION_AMAZING,0),Object(l.a)(e,O.REACTION_DISLIKE,0),Object(l.a)(e,O.REACTION_LIKE,0),e));c(t)}),[p]),Object(a.useEffect)((function(){p.filter((function(e){var t=e.type;e.idAuthor===d.id&&u(t)}))}),[d]);var I=function(e){e?(S=!0,document.querySelector("#popover-".concat(t)).classList.add("active-hover")):S&&setTimeout((function(){S=!1,document.querySelector("#popover-".concat(t)).classList.remove("active-hover")}),1e3)},C=function(e){g(t,{type:e,idAuthor:d.id})};return Object(n.jsxs)("div",{className:"post-item-buttons popover",children:[Object(n.jsxs)("p",{className:"trigger-popover",onMouseEnter:function(){I(!0)},onMouseLeave:function(){I(!1)},children:[s===O.REACTION_LIKE&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("img",{src:T,alt:"like"})," Me Gusta"]}),s===O.REACTION_DISLIKE&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("img",{src:R,alt:"like"})," No me Gusta"]}),s===O.REACTION_AMAZING&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("img",{src:w,alt:"like"})," Asombroso"]}),!s&&"Reacccionar"]}),Object(n.jsxs)("div",{id:"popover-".concat(t),className:"popover-content",children:[Object(n.jsx)("div",{className:"arrow"}),Object(n.jsx)("img",{src:T,alt:"like",className:"ml-10",onClick:function(){return C(O.REACTION_LIKE)}}),Object(n.jsx)("img",{src:R,alt:"dislike",onClick:function(){return C(O.REACTION_DISLIKE)}}),Object(n.jsx)("img",{src:w,alt:"amazing",onClick:function(){return C(O.REACTION_AMAZING)}})]})]})},y=function(e){var t,c=e.id,r=e.desc,i=e.nameAuthor,s=e.date,u=Object(a.useState)((t={},Object(l.a)(t,O.REACTION_AMAZING,0),Object(l.a)(t,O.REACTION_DISLIKE,0),Object(l.a)(t,O.REACTION_LIKE,0),t)),d=Object(o.a)(u,2),j=d[0],p=d[1],x=Object(a.useContext)(v).stateUser,g=I({comment:""}),N=Object(o.a)(g,3),E=N[0],S=N[1],T=N[2],R=function(e){var t=function(){try{var t=function(){var t=Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.doc(e).collection(O.COLLECTION_COMMENTS).orderBy("date","desc").get();case 2:t.sent.forEach((function(e){c.push(e.data())})),s.current&&i(Object(b.a)(Object(b.a)({},r),{},{data:c,loading:!1,error:null}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=[];t()}catch(n){i(Object(b.a)(Object(b.a)({},r),{},{data:null,loading:!1,error:n}))}},c=Object(a.useState)({action:t,data:[],loading:!0,error:null}),n=Object(o.a)(c,2),r=n[0],i=n[1],s=Object(a.useRef)(!0);return Object(a.useEffect)((function(){return s.current=!0,t(),function(){s.current=!1}}),[]),r}(c),w=R.action,_=R.data,y=function(){var e=Object(a.useContext)(v).setStateModal,t=Object(a.useState)({action:function(t,c){r(Object(b.a)(Object(b.a)({},n),{},{loading:!0})),L.doc(t).collection(O.COLLECTION_COMMENTS).add(c).then((function(e){e.set({id:e.id},{merge:!0}).then((function(){r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:null,isFirtsRender:!1}))}))})).catch((function(){r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:"Ocurrio un error",isFirtsRender:!1})),e({isShow:!0,title:"Ocurri\xf3 un error.",desc:"No se pudo agregar el comentaro, intenta m\xe1s tarde.",icon:"error"})}))},loading:!1,error:null,isFirtsRender:!0}),c=Object(o.a)(t,2),n=c[0],r=c[1];return n}(),F=y.action,D=y.loading,M=y.isFirtsRender,P=new Date(null===s||void 0===s?void 0:s.toDate()).toLocaleDateString();Object(a.useEffect)((function(){M||D||(T(),w())}),[D]);return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"post-item my-2 ",children:[Object(n.jsxs)("div",{className:"post-item-content",children:[Object(n.jsx)("div",{className:"item-profile",children:Object(n.jsx)("img",{className:"profile-img",src:C,alt:i})}),Object(n.jsxs)("div",{className:"post-item-desc",children:[Object(n.jsxs)("div",{className:"post-desc-group-name",children:[Object(n.jsx)("p",{className:"post-item-name title-name",children:i}),Object(n.jsx)("p",{className:"post-item-time text-time",children:P})]}),Object(n.jsx)("p",{children:r}),Object(n.jsx)(k,{idPost:c,setReactionsState:p})]})]}),Object(n.jsxs)("div",{className:"post-item-reaction",children:[Object(n.jsxs)("div",{className:"reactions-group-circles",children:[(null===j||void 0===j?void 0:j.like)>0&&Object(n.jsx)("div",{className:"circle-likes"}),(null===j||void 0===j?void 0:j.dislike)>0&&Object(n.jsx)("div",{className:"circle-dislike"}),(null===j||void 0===j?void 0:j.amazing)>0&&Object(n.jsx)("div",{className:"circle-amazing"}),Object(n.jsx)("p",{children:(null===j||void 0===j?void 0:j.amazing)+(null===j||void 0===j?void 0:j.like)+(null===j||void 0===j?void 0:j.dislike)})]}),Object(n.jsx)("p",{children:_.length>0&&Object(n.jsxs)(n.Fragment,{children:[_.length," comentario",_.length>1&&"s"]})})]}),Object.keys(_).length>0&&Object(n.jsx)("div",{className:"comments-list",children:_.map((function(e,t){return Object(n.jsx)("div",{children:Object(n.jsx)(A,Object(b.a)(Object(b.a)({},e),{},{index:t}))},e.id)}))}),x.isLoggedIn?Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),F(c,{date:new Date,desc:E.comment,idAuthor:x.id,nameAuthor:x.userName}),T()},className:"comment-form ",children:[Object(n.jsx)("textarea",{name:"comment",placeholder:"Escribe un comentario",autoComplete:"off",rows:"1",className:"comment",value:E.comment,onChange:S}),Object(n.jsx)(m,{isLoading:!1,children:Object(n.jsx)("button",{type:"submit",disabled:!E.comment,children:Object(n.jsx)("span",{children:"Publicar"})})})]}):Object(n.jsx)("p",{className:"msgInfoAddComment",children:"Inicia sesi\xf3n para poder comentar"})]})})},F=E.collection(O.COLLECTION_USERS),D=function(){var e=I({userName:"",password:""}),t=Object(o.a)(e,3),c=t[0],r=t[1],i=t[2],s=function(){var e=function(){var e=Object(h.a)(f.a.mark((function e(t){var c,a,o,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.userName,a=t.password,e.prev=1,e.next=4,F.where("userName","==",c).where("password","==",a).limit(1).get();case 4:o=e.sent,l={},o.forEach((function(e){var t=e.data();console.log(t),t&&(l={id:t.id,userName:t.userName,isAdmin:t.isAdmin,isLoggedIn:!0})})),s.current&&(i(l),r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:null}))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),s.current&&r(Object(b.a)(Object(b.a)({},n),{},{loading:!1,error:e.t0}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),t=Object(a.useState)({action:e,loading:!0,error:null}),c=Object(o.a)(t,2),n=c[0],r=c[1],i=Object(a.useContext)(v).setStateUser,s=Object(a.useRef)(!0);return Object(a.useEffect)((function(){return function(){s.current=!1}}),[]),n}(),l=s.action,u=s.loading,d=function(){var e=function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(Object(b.a)(Object(b.a)({},s),{},{loading:!0})),F.add(t).then((function(e){e.set({id:e.id},{merge:!0}).then((function(){l(Object(b.a)(Object(b.a)({},s),{},{loading:!1,error:null,isFirtsRender:!1})),c({title:"Estado creado",desc:"Se ha registrado exitosamente.",isShow:!0}),n({id:e.id,userName:t.userName,isAdmin:!1,isLoggedIn:!0})})).catch((function(e){console.log(e)}))})).catch((function(){l(Object(b.a)(Object(b.a)({},s),{},{loading:!1,error:"Ocurrio un error",isFirtsRender:!1})),c({isShow:!0,title:"Ocurri\xf3 un error.",desc:"No se pudo crear el usuario, intenta m\xe1s tarde.",icon:"error"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=Object(a.useContext)(v),c=t.setStateModal,n=t.setStateUser,r=Object(a.useState)({action:e,loading:!1,error:null,isFirtsRender:!0}),i=Object(o.a)(r,2),s=i[0],l=i[1];return s}(),j=d.action;d.loading,d.isFirtsRender;return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),l(c),i()},className:"form-login",children:[Object(n.jsxs)("div",{className:"section-inputs",children:[Object(n.jsxs)("div",{className:"input-group",children:[Object(n.jsx)("label",{htmlFor:"user",children:"Usuario:"}),Object(n.jsx)("input",{type:"text",id:"user",name:"userName",autoComplete:"off",onChange:r,value:c.userName,placeholder:"Ingresa el usuario"})]}),Object(n.jsxs)("div",{className:"input-group",children:[Object(n.jsx)("label",{htmlFor:"pass",children:"Password:"}),Object(n.jsx)("input",{type:"password",id:"pass",name:"password",autoComplete:"off",onChange:r,placeholder:"Ingresa la contrase\xf1a",value:c.password})]})]}),Object(n.jsx)(m,{isLoading:!u,children:Object(n.jsxs)("div",{className:"section-buttons",children:[Object(n.jsx)("button",{type:"submit",disabled:!c.userName||!c.password,children:"Iniciar sesi\xf3n"}),Object(n.jsx)("p",{children:"o"}),Object(n.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),j(Object(b.a)(Object(b.a)({},c),{},{isAdmin:!1,dateCreated:new Date})),i()},disabled:!c.userName||!c.password,children:"Registrarse"})]})})]})})},M=function(e){var t=e.getAllPost,c=Object(a.useContext)(v).stateUser,r=I({post:""}),i=Object(o.a)(r,3),s=i[0],l=i[1],u=i[2],d=function(){var e=function(){var e=Object(h.a)(f.a.mark((function e(c){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(Object(b.a)(Object(b.a)({},r),{},{loading:!0})),S.add(c).then((function(e){e.set({id:e.id},{merge:!0}).then((function(){i(Object(b.a)(Object(b.a)({},r),{},{loading:!1,error:null,isFirtsRender:!1})),t({title:"Estado creado",desc:"Se ha creado la publicaci\xf3n",isShow:!0})}))})).catch((function(){i(Object(b.a)(Object(b.a)({},r),{},{loading:!1,error:"Ocurrio un error",isFirtsRender:!1})),t({isShow:!0,title:"Ocurri\xf3 un error.",desc:"No se pudo crear la publicaci\xf3n, intenta m\xe1s tarde.",icon:"error"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=Object(a.useContext)(v).setStateModal,c=Object(a.useState)({action:e,loading:!1,error:null,isFirtsRender:!0}),n=Object(o.a)(c,2),r=n[0],i=n[1];return r}(),j=d.action,p=d.loading,x=d.isFirtsRender;Object(a.useEffect)((function(){x||p||(u(),t())}),[p]);return Object(n.jsx)(n.Fragment,{children:c[O.IS_LOGGED]?Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),j({date:new Date,desc:s.post,idAuthor:c.id,nameAuthor:c.userName})},className:"post-form",children:[Object(n.jsx)("textarea",{name:"post",placeholder:"Escribe aqu\xed tu estado",autoComplete:"off",className:"post-text",value:s.post,onChange:l}),Object(n.jsx)(m,{isLoading:!1,children:Object(n.jsx)("button",{type:"submit",disabled:!s.post,children:"Publicar"})})]}):Object(n.jsx)(D,{})})},P=function(){var e=function(){var e=function(){var e=Object(h.a)(f.a.mark((function e(){var t,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.orderBy("date","desc").get();case 3:t=e.sent,c=[],t.forEach((function(e){c.push(Object(b.a)({id:e.id},e.data()))})),i.current&&r(Object(b.a)(Object(b.a)({},n),{},{data:c,loading:!1,error:null})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i.current&&r(Object(b.a)(Object(b.a)({},n),{},{data:null,loading:!1,error:e.t0}));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t=Object(a.useState)({action:e,data:[],loading:!0,error:null}),c=Object(o.a)(t,2),n=c[0],r=c[1],i=Object(a.useRef)(!0);return Object(a.useEffect)((function(){return e(),function(){i.current=!1}}),[]),n}(),t=e.action,c=e.data,r=e.loading;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(M,{getAllPost:t}),Object(n.jsx)("div",{className:"content-list",children:Object(n.jsx)(m,{isLoading:r,children:(null===c||void 0===c?void 0:c.length)?c.map((function(e,t){return Object(n.jsx)(y,Object(b.a)(Object(b.a)({},e),{},{index:t}),e.id)})):Object(n.jsx)("p",{children:"No hay publicaciones"})})})]})},U=c.p+"static/media/exit.cc46a70e.svg",G=function(){var e=Object(a.useContext)(v),t=e.stateUser,c=e.logout;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("header",{className:"post-banner",children:[Object(n.jsx)(u.b,{to:O.ROUTE_POSTS,className:"post-title",children:"Publicaciones"}),t.isLoggedIn&&Object(n.jsxs)("div",{className:"user-logged",children:[Object(n.jsxs)("p",{style:{marginLeft:"auto"},children:["Bienvenido, ",t.userName," "]}),Object(n.jsx)("img",{src:U,alt:"exit",onClick:function(e){e.preventDefault(),c()}})]})]}),Object(n.jsx)("section",{className:"post-section",children:Object(n.jsx)(d.d,{children:Object(n.jsx)(d.b,{exact:!0,path:O.ROUTE_POSTS,component:P})})})]})},K=function(){return Object(n.jsx)(u.a,{children:Object(n.jsx)("div",{className:"main",children:Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{path:O.ROUTE_POSTS,component:G}),Object(n.jsx)(d.b,{path:O.ROUTE_LOGIN,component:j}),Object(n.jsx)(d.a,{to:O.ROUTE_POSTS})]})})})},z=c(30),B=c.n(z),Z=(c(44),Object(l.a)({},O.IS_LOGGED,!1)),q=function(){var e=Object(a.useState)({isShow:!1,title:"",desc:"",icon:""}),t=Object(o.a)(e,2),c=t[0],r=t[1],i=Object(a.useState)(Z),s=Object(o.a)(i,2),l=s[0],u=s[1],d=c.isShow,j=c.title,b=c.desc,p=c.icon;Object(a.useEffect)((function(){d&&B.a.fire({title:j,text:b,icon:p||"success",confirmButtonText:"Aceptar"})}),[c]);var x=function(e){var t=Object(a.useRef)(!0),c=Object(a.useState)({data:null,loading:!0,error:null}),n=Object(o.a)(c,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){return function(){t.current=!1}}),[]),Object(a.useEffect)((function(){function c(){return(c=Object(h.a)(f.a.mark((function c(){var n,a,r;return f.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,fetch(e);case 3:return n=c.sent,c.next=6,n.json();case 6:a=c.sent,r=a.data,t.current&&i({loading:!1,error:null,data:r}),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(0),i({data:null,loading:!1,error:"No se pudo cargar la info"});case 14:case"end":return c.stop()}}),c,null,[[0,11]])})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[e]),r}(O.ENDPOINT_LANG_ES),v=x.data,N=x.loading;return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(m,{isLoading:N,children:Object(n.jsx)(g,{value:{stateModal:c,setStateModal:r,lang:v,stateUser:l,setStateUser:u,logout:function(){u(Z)}},children:Object(n.jsx)(K,{})})})})};s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(q,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.d0229f94.chunk.js.map